{% extends "base_site.html" %}

{% block title %} Homepage {% endblock title %}

{% block stylesheets %}
  {{ super() }}
{% endblock stylesheets %}

{% block body_class %}nav-sm{% endblock %}
{% block sidebar_class %}menu_fixed{% endblock %}
{% block top_navigation %}{% endblock %}

{% block content %}
  <div class="right_col" role="main">
    <!-- top tiles -->
    <div class="row tile_count">
        {% for tile in top_stats %}
            {% with title=tile.name, count=tile.value, count_change=tile.change, icon=tile.icon, count_color=tile.count_color%}
                <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
                    {% include "parts/top_tile.html" %}
                </div>
            {% endwith %}
        {% endfor %}
    </div>

    <!-- /top tiles -->

    {% with title="Evoluția numărului de cazuri în România", chart_id="chart_line_romania" %}
        {% include "parts/line_graph.html" %}
    {% endwith %}
    {% if incidence %}
        {% with title="Incidența cazurilor pe județe", chart_id="bar_chart_incidence" %}
            {% include "parts/bar_chart_group.html" %}
        {% endwith %}
    {% endif %}
    {% if infections %}
        {% with title="Numărul infectărilor pe județe", chart_id="bar_chart_infections" %}
            {% include "parts/bar_chart_group.html" %}
        {% endwith %}
    {% endif %}
  </div>
{% endblock content %}

{% block javascripts %}
    {{ super()}}
    <script src="{{ url_for('static', filename='vendors/echarts/dist/echarts.min.js') }}"></script>
    <script src="{{ url_for('static', filename='vendors/raphael/raphael.min.js') }}"></script>
    <script src="{{ url_for('static', filename='vendors/morris.js/morris.min.js') }}"></script>
    <script src="{{ url_for('static', filename='build/js/line_graph.js') }}"></script>
    <script src="{{ url_for('static', filename='build/js/bar_chart.js') }}"></script>
    <script type="text/javascript">
        init_e_chart_line(
            '{{ archive|tojson }}',
            chart_id="chart_line_romania",
            for_homepage=true,
            date_key='Data'
        )
        init_bar_chart (
            '{{ incidence|tojson }}',
            chart_id="bar_chart_incidence",
            y_key="incidence",
        )
        init_bar_chart (
            '{{ infections|tojson }}',
            chart_id="bar_chart_infections",
            y_key="infections",
        )
    </script>
{% endblock javascripts %}
